#!/usr/bin/env python
#coding=utf-8

__author__ = 'm0nsieurPsych0'

import re
import requests
import bs4
import time
import hashlib
from base64 import b64decode, b64encode

'''
The challenge:
                You have 3 seconds to get the secret word.
                Send the answer back using https://ringzer0ctf.com/challenges/15/[your_string]
'''
'''
The writeup:
                The elf message is in base64 see the "==" at the end.
                We also notice a lot of line of the elf message is repeating 

                There is also a checksum (most likely md5), which mean possibly two things:
                1- the checksum is the correct value we are looking for
                2- this is the exact checksum of the b64 elf message (which would not help us)
                3- The md5 process uses padding for the message to reach 448 bit.  

                One other possibility is that "elf" stands for "Executable and Linkable Format"

                sources: 
                            https://www.educba.com/md5-alogrithm/

'''

class Read_me_if_you_can_17():
    def __init__(self):
        self._baseURL = "https://ringzer0ctf.com/challenges/"
        self._challengeNumber = "15"
        # DESTROY!!!!!!!
        self._username = "*"
        self._password = "*"
        # DESTROY!!!!!!!
        
    def _decodeElfMessage(self):
        # print(hashlib.md5(b'CgB0aW5pXwA1LjIuMl9DQklMR0BAcGVlbHMAZWxiYVRlbm9sQ01UcmV0c2lnZXJfTVRJXwBfX0RORV9DTVRfXwBzZXNzYWxDcmV0c2lnZVJfdkpfAG5pYW0AdHJhdHNfc3NiX18AdHJhdHNfAGRuZV8AdGluaV91c2NfY2JpbF9fAGRlc3VfbmlkdHNfT0lfAGVsZG5haF9vc2RfXwBfX3RyYXRzX25vbWdfXwB0cmF0c19hdGFkX18ANS4yLjJfQ0JJTEdAQG5pYW1fdHJhdHNfY2JpbF9fADQuMl9DQklMR0BAbGlhZl9raGNfa2NhdHNfXwBpbmlmXwBhdGFkZV8ANS4yLjJfQ0JJTEdAQHN0dXAAdHJhdHNfYXRhZABlbGJhVGVub2xDTVRyZXRzaWdlcmVkX01USV8AaW5pZl91c2NfY2JpbF9fAF9FTEJBVF9URVNGRk9fTEFCT0xHXwB0cmF0c195YXJyYV90aW5pX18AQ0lNQU5ZRF8AZG5lX3lhcnJhX3RpbmlfXwBfX0RORV9SQ0pfXwBfX0RORV9FTUFSRl9fAGMudHNldAB5cnRuZV95YXJyYV90aW5pX3ltbXVkX2VtYXJmX18AeW1tdWRfZW1hcmYAeXJ0bmVfeWFycmFfaW5pZl94dWFfc3JvdGRfbGFib2xnX29kX18ANDQ3Ni5kZXRlbHBtb2MAeHVhX3Nyb3RkX2xhYm9sZ19vZF9fAHNlbm9sY19tdF9yZXRzaWdlcgBzZW5vbGNfbXRfcmV0c2lnZXJlZABfX1RTSUxfUkNKX18AYy5mZnV0c3RyYwB0cmF0c19ub21nX2xsYWMAby5pdHJjL3VuZy14dW5pbC00Nl82OHgvLi4vLi4vLi4vNy40L3VuZy14dW5pbC00Nl82OHgvY2NnL2JpbC9yc3UvAAAAAAAAAAAAAAAAAABABGAACwASAAACsgAAAAAAAAAAAAAAAAAAAAAAAAASAAACnwAAAAAAAAAAAAAAAAAAAAAAAAAgAAAChQAAAAAAAAAAAAAAAABgEEgAGAIRAAACeQAAAAAAAAAAAAAAAAAAAAAAAAAgAAACZQAAAAAAAABeAAAAAABABcwADQASAAACYAAAAAAAAAAAAAAAAABgEEgAGQAQAAACVAAAAAAAAAAAAAAAAABABMAADQASAAACTQAAAAAAAAAAAAAAAABgEFAAGQAQAAACSAAAAAAAAACJAAAAAABABjAADQASAAACOAAAAAAAAAAEAAAAAABABtAADwARAAACKQAAAAAAAAAAAAAAAABgEEAAGAIRAAACHAAAAAAAAAAAAAAAAAAAAAAAAAAgAAACDQAAAAAAAAAAAAAAAABgEDgAGAAQAAACAAAAAAAAAAAAAAAAAAAAAAAAAAASAAAB4QAAAAAAAAAAAAAAAAAAAAAAAAASAAABxQAAAAAAAAAAAAAAAABABsQADgASAAABvwAAAAAAAAAAAAAAAABgEEgAGAAQAAABuAAAAAAAAAAAAAAAAAAAAAAAAAASAAABpgAAAAAAAAAAAAAAAABgEDgAGAAgAAABmwAAAAAAAAAAAAAAAAAAAAAAAAAgAAABfwAAAAAAAAACAAAAAABABsAADQASAAABbwAAAAAAAAAAAAAAAABgEAAAFwABAAABWQAAAAAAAAAAAAAAAABgDhAAEgAAAAABRgAAAAAAAAAAAAAAAABgDigAFQABAAABPQAAAAAAAAAAAAAAAABgDhgAEgAAAAABLAAAAAAAAAAAAAAAAAAAAAD/8QAEAAAAAAAAAAAAAAAAAAAAAABgDiAAFAABAAABIAAAAAAAAAAAAAAAAABAB6AAEQABAAABEgAAAAAAAAAAAAAAAAAAAAD/8QAEAAAAVAAAAAAAAAAAAAAAAAAAAAD/8QAEAAABCwAAAAAAAAAAAAAAAABgDhAAEgABAAAA7AAAAAAAAAAAAAAAAABABaAADQACAAAA4AAAAAAAAAAAAAAAAABgDhgAEwABAAAAuQAAAAAAAAABAAAAAABgEEgAGQABAAAAqgAAAAAAAAAAAAAAAABABYAADQACAAAAlAAAAAAAAAAAAAAAAABABUAADQACAAAAgQAAAAAAAAAAAAAAAABABRAADQACAAAAbAAAAAAAAAAAAAAAAABgDiAAFAABAAAAXwAAAAAAAAAAAAAAAAAAAAD/8QAEAAAAVAAAAAAAAAAAAAAAAABABOwADQACAAAARAAAAAAAAAAAAAAAAAAAAAD/8QAEAAAAAQAAAAAAAAAAAAAAAAAAAAAAGgADAAAAAAAAAAAAAAAAAAAAAABgEEgAGQADAAAAAAAAAAAAAAAAAAAAAABgEDgAGAADAAAAAAAAAAAAAAAAAAAAAABgEAAAFwADAAAAAAAAAAAAAAAAAAAAAABgD/gAFgADAAAAAAAAAAAAAAAAAAAAAABgDigAFQADAAAAAAAAAAAAAAAAAAAAAABgDiAAFAADAAAAAAAAAAAAAAAAAAAAAABgDhgAEwADAAAAAAAAAAAAAAAAAAAAAABgDhAAEgADAAAAAAAAAAAAAAAAAAAAAABABwAAEQADAAAAAAAAAAAAAAAAAAAAAABABtQAEAADAAAAAAAAAAAAAAAAAAAAAABABtAADwADAAAAAAAAAAAAAAAAAAAAAABABsQADgADAAAAAAAAAAAAAAAAAAAAAABABMAADQADAAAAAAAAAAAAAAAAAAAAAABABHAADAADAAAAAAAAAAAAAAAAAAAAAABABGAACwADAAAAAAAAAAAAAAAAAAAAAABABAAACgADAAAAAAAAAAAAAAAAAAAAAABAA+gACQADAAAAAAAAAAAAAAAAAAAAAABAA7gACAADAAAAAAAAAAAAAAAAAAAAAABAA6YABwADAAAAAAAAAAAAAAAAAAAAAABAA0gABgADAAAAAAAAAAAAAAAAAAAAAABAArgABQADAAAAAAAAAAAAAAAAAAAAAABAApgABAADAAAAAAAAAAAAAAAAAAAAAABAAnQAAwADAAAAAAAAAAAAAAAAAAAAAABAAlQAAgADAAAAAAAAAAAAAAAAAAAAAABAAjgAAQADAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAK4AAAAAAAAH7gAAAAAAAAAAAAAAAAAAAAAAAAAAwAAAAkAAAAAAAAAGAAAAAAAAAAIAAAALwAAAB0AAAAAAAAGeAAAAAAAABlAAAAAAAAAAAAAAAAAAAAAAAAAAAIAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAQgAAAAAAAAQswAAAAAAAAAAAAAAAAAAAAAAAAADAAAAEQAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAABrAAAAAAAAEEgAAAAAAAAAAAAAAAAAAAAwAAAAAQAAAP8AAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAACAAAAAAAABBIAAAAAABgEEgAAAAAAAAAAwAAAAgAAAD6AAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAABAAAAAAAAAQOAAAAAAAYBA4AAAAAAAAAAMAAAABAAAA9AAAAAAAAAAIAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAA4AAAAAAAAEAAAAAAAAGAQAAAAAAAAAAADAAAAAQAAAOsAAAAAAAAACAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAA/4AAAAAABgD/gAAAAAAAAAAwAAAAEAAADmAAAAAAAAABAAAAAAAAAACAAAAAAAAAAGAAAAAAAAAdAAAAAAAAAOKAAAAAAAYA4oAAAAAAAAAAMAAAAGAAAA3QAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAAAIAAAAAAAADiAAAAAAAGAOIAAAAAAAAAADAAAAAQAAANgAAAAAAAAAAAAAAAAAAAAIAAAAAAAAAAAAAAAAAAAACAAAAAAAAA4YAAAAAABgDhgAAAAAAAAAAwAAAA8AAADMAAAAAAAAAAAAAAAAAAAACAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAOEAAAAAAAYA4QAAAAAAAAAAMAAAAOAAAAwAAAAAAAAAAAAAAAAAAAAAgAAAAAAAAAAAAAAAAAAACkAAAAAAAABwAAAAAAAEAHAAAAAAAAAAACAAAAAQAAALYAAAAAAAAAAAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAALAAAAAAAAAbUAAAAAABABtQAAAAAAAAAAgAAAAEAAACoAAAAAAAAAAQAAAAAAAAABAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAG0AAAAAAAQAbQAAAAAAAAABIAAAABAAAAoAAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAJAAAAAAAABsQAAAAAAEAGxAAAAAAAAAAGAAAAAQAAAJoAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAACBAAAAAAAAATAAAAAAABABMAAAAAAAAAABgAAAAEAAACUAAAAAAAAABAAAAAAAAAAEAAAAAAAAAAAAAAAAAAAAFAAAAAAAAAEcAAAAAAAQARwAAAAAAAAAAYAAAABAAAAiQAAAAAAAAAAAAAAAAAAAAQAAAAAAAAAAAAAAAAAAAAOAAAAAAAABGAAAAAAAEAEYAAAAAAAAAAGAAAAAQAAAI4AAAAAAAAAGAAAAAAAAAAIAAAADAAAAAUAAAAAAAAA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AAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAv///zAAAACMAAAAFAAAAAgOWAIEjQOOAo8Hg0AOXwaGBYxRAAAAAIn///7IAAAAZAAAACQAAAgHDFkCBg1DAoYQDkEAAAAAXv///oQAAABEAAAAHAAAAAAiJDMqOxo/AIAIdwsPShgORhAOAAAAAFD///1QAAAAHAAAACQAAAGQCAcMGwEQeAEAUnoBAAAAAAAAABQAAAC0////7AAAAIz///9cAAAAbP///vgAAABE///9nAAAAAQAAAAoOwMbAQACAAEAAADDCMSDSAjsg0iQZsPzAAAAAIAfD8M4xINIMCR8i0woJHSLTCAkbItMGCRki0wQJGyLSAgkXItI6nXrOUgBw4NI3BT/Qe+JRPaJTPqJTABAHw/bMRx07YVI///96+jXiUkD/cFI9olJ/YlB5SlMOOyDSNAkXIlI+CR8iUzwJHSJTOgkbIlMACAHyCWNTAAgB9ctjUjgJGSJTNgkbIlIAABEHw9mw8n///5o6AV0AAAAKCUUM0hk+FWLSAAAAAC4///+cejHiUjwRY1I///+regAAAAAuAAAAAK/APZFxmNi9EXHZmo1WjTwRcfAMfhFiUgAAAAoJQSLSGQQ7INI5YlIVZBm////dun///976V3Q/+WJSABgDiC/VRF0wIVIAAAAALgbdAAAIAh4PYNIAEAfD8PzAQAgCq4Fxl3///9+6OWJSFURdQAAIArBPYAAAAAAgB8P4v8AYBBIv130dNKFSAAAAAC6w10Cdf7RSMaJSNABSD/qwUjCiUjliUgD+MFIAGAQSC1IVQBgEEi4AAAAAIAfD+D/AGAQSL9d9HTAhUgAAAAAuMNdAnfliUgO+INIAGAQSC1IVQBgEE+4AB8PAAAAAACEHw8uZsMIxINI0P8CdMCFSAAgCwEFi0gI7INIkGb0////t+gAQAXMx8dIAEAGMMHHSABABsDAx0lUUPDkg0jiiUhe0YlJ7TH///+w6QAAAANoACALeiX/////wOkAAAACaAAgC4Il/////9DpAAAAAWgAIAuKJf/////g6QAAAABoACALkiX/AEAfDwAgC5Ql/wAgC5I1/wAAwwjEg0gAAACD6Ajsg0gAAAAAAAAAAAAAAAUAAAAHAAAAAABgEDAAAAAAAAAAAAAAAAMAAAAHAAAAAABgECgAAAAAAAAAAAAAAAIAAAAHAAAAAABgECAAAAAAAAAAAAAAAAEAAAAHAAAAAABgEBgAAAAAAAAAAAAAAAQAAAAGAAAAAABgD/gAAAAAAAAAUgACAAAJaRp1AAAAEAAAAEgAAwAADWlpFAAAAAAAAAAQAAAAEAACAAEAAAAAAAAAAgAAAAIAAwACAAAANS4yLjJfQ0JJTEcANC4yX0NCSUxHAG5pYW1fdHJhdHNfY2JpbF9fAHBlZWxzAGxpYWZfa2hjX2tjYXRzX18Ac3R1cAA2Lm9zLmNiaWwAX190cmF0c19ub21nX18AAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAwAAAAAAAAAAAAAAAAAAAAAAAAACAAAAABAAAAAAAAAAAAAAAAAAAAAAAAABIAAAA2AAAAAAAAAAAAAAAAAAAAAAAAABIAAAAfAAAAAAAAAAAAAAAAAAAAAAAAABIAAAAaAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAABAAAAAQAAAAHPF5siBNSyf04b2xn+Hk7q+TIOqwBVTkcAAAADAAAAFAAAAAQAAAAYAAAABgAAAAIAAAAAAFVORwAAAAEAAAAQAAAABAAyLm9zLjQ2LTY4eC14dW5pbC1kbC80NmJpbC8AAAAAAAAAAQAAAAAAAAHwAAAAAAAAAfAAAAAAAGAOEAAAAAAAYA4QAAAAAAAADhAAAAAEZHTlUgAAAAAAAAAIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAZkdOVRAAAAAAAAAAQAAAAAAAAALAAAAAAAAAAsAAAAAABABtQAAAAAAEAG1AAAAAAAAAbUAAAABGR05VAAAAAAAAAABAAAAAAAAABEAAAAAAAAAEQAAAAAAEACVAAAAAAAQAJUAAAAAAAAAlQAAAAEAAAABAAAAAAAAAAIAAAAAAAAAdAAAAAAAAAB0AAAAAAAYA4oAAAAAABgDigAAAAAAAAOKAAAAAYAAAACAAAAAAAgAAAAAAAAAAACQAAAAAAAAAI4AAAAAABgDhAAAAAAAGAOEAAAAAAAAA4QAAAABgAAAAEAAAAAACAAAAAAAAAAAAekAAAAAAAAB6QAAAAAAEAAAAAAAAAAQAAAAAAAAAAAAAAAAAAFAAAAAQAAAAAAAAABAAAAAAAAABwAAAAAAAAAHAAAAAAAQAI4AAAAAABAAjgAAAAAAAACOAAAAAQAAAADAAAAAAAAAAgAAAAAAAAB+AAAAAAAAAH4AAAAAABAAEAAAAAAAEAAQAAAAAAAAABAAAAABQAAAAYAGwAeAEAACQA4AEAAAAAAAAAAAAAAEcAAAAAAAAAAQAAAAAAAQATAAAAAAQA+AAIAAAAAAAAAAAABAQJGTEV/').hexdigest())
    
    def _writeFlag(self, flag):
        with open("flag.txt", "w", encoding="utf-8") as f:
            f.write(flag)

    def _pageRequests(self):
        payload = {'action': 'login', 'username': self._username, 'password': self._password}

        # Start the timer        
        tz = time.perf_counter()
        with requests.session() as c:
            # login using our credentials
            c.post('https://ringzer0ctf.com/login', data=payload)

            # we parse the page
            response = c.get(f"{self._baseURL}{self._challengeNumber}")
            
            html = bs4.BeautifulSoup(response.text, features="html5lib")
            tag = html.findAll("div",{"class":"message"})
                
            # we use a regex to catch everything between <br/> tags
            b64Payload = re.search(r'(<img src="data:image\/png;base64,)(.*)"/>', str(tag[0])).group(2).strip()
            
            # calling the ocr function on the payload
            answer = None
            
            print(answer)

            # we send the clear text answer
            response = c.get(f"{self._baseURL}{self._challengeNumber}/{answer}")
            # find the flag
            flag = re.search(r'<div class="alert alert-info">(.*)</div>', str(response.text))
            # We return the flag
            try:
                return tz, flag.group(1)
            except AttributeError:
                # if there is no group for the flag variable we failed
                return tz, None
    
    def main(self):
        flag = None
        self._decodeElfMessage()
        # Start the process
        # while flag is None:
        #     # Sleep 5 seconds on fail
        #     time.sleep(5)
            
        #     tz, flag = self._pageRequests()
        
        # print(f"time elapse: {time.perf_counter() - tz}")

        # # Print stats and flag
        # print(flag)

        # # Write flag to file
        # self._writeFlag(flag)

if __name__ == "__main__":
    Read_me_if_you_can_17().main()